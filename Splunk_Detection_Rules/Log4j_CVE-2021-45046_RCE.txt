index=<your_index>
|eval dest=coalesce(dest,dest_ip,dst) 
|search NOT [|inputlookup ScannerIPs.csv|dedup dest|fields dest] 
|eval Event=_raw|stats last(Event) as Event last(joinmatch) as joinmatch by dest |join dest 
[|search index=index=<your_proxy_fw_index> "*${${::-j}${::-n}*" OR "*${${::-j}*" OR "*${${lower:j*" OR "*${${lower:r*" OR "*:r}m${lower:i}*" OR "*${jndi:*" earliest=-24h latest=now
| rex field=_raw "(\$*?ndi.*\/\/|lower:rmi\}\:\/?\/?|{lower:i\}?\}?\:\/?\/?|\${\${::-j}\${::-n}\${::-d}\${::-i}:\${::-r}\${::-m}\${::-i}:\/?\/?|\${\${::-j}\${::-n}\${::-d}\${::-i}:\${::-l}\${::-d}\${::-a}\${::-p}:\/\/|\${lower:\/}\/?|{lower:ldap}:\/\/|\${\${lower:jn}di:ldap:\/\/)(\d+\.\d+\.\d+\.\d*|[\-A-z0-9\.?\d+?]*)#(?<dest>\d+\.\d+\.\d+\.\d*|[\-A-z0-9\.?\d+?]*)"
|eval dest=if(dest="","IGNOREME",dest)
|eval dest=if(dest="127.0.0.1","IGNOREME",dest)
|eval match="match for exploit attempt"
|search dest!="\\\\"|dedup dest
|eval joinmatch=_raw|fields dest, match,joinmatch] 
|search match="match for exploit attempt"
